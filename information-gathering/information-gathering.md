# Tìm hiểu Information Gathering
> TÊN TÀI LIỆU: Information Gathering Document<br>
THỰC HIỆN: Dương Tôn Hoàng Khang <br>
CẬP NHẬT CUỐI CÙNG: 01/10/2024<br>
>
# Lời mở đầu:<br>
Bản báo cáo này giới thiệu về quy trình thu thập thông tin (Information Gathering) theo OWSAP TOP trong bảo mật Web Application, mục đích phát hiện các lỗ hổng, thông tin nhạy cảm và điểm yếu của hệ thống.<br>
# Key cases according to OWASP TOP 10:
#### [1. What is Information Gathering?](#p1)<br>
#### [2. Conduct Search Engine Discovery Reconnaissance for Information Leakage](#p2)<br>
#### [3. Fingerprint Web Server](#p3)<br>
#### [4. Review Webserver Metafiles for Information Leakage](#p4)<br>
#### [5. Enumerate Applications on Webserver](#p5)<br>
#### [6. Review Webpage Content for Information Leakage](#p6)<br>
#### [7. Identify Application Entry Points](#p7)<br>
#### [8. Map Execution Paths Through Application](#p8)<br>
#### [9. Fingerprint Web Application Framework](#p9)<br>
# Nội dung:<br>
<a id="p1"></a>
## 1. What is Information Gathering?<br>
Là bước đầu tiên phải có trong quá trình Pentest, mục tiêu của Information Gathering là thu thập thật nhiều thông tin nhất có thể của Target như Domain, Subdomain, Technology, Port Service, Sensitive Files,... để phục vụ cho quá trình Pentest.<br>
<a id="p2"></a>
## 2. Conduct Search Engine Discovery Reconnaissance for Information Leakage<br>
Là quá trình thu thập thông tin thông qua các công cụ tìm kiếm như: Goolgle, Bing,... để thu thập các thông tin nhạy cảm có thể bị rò rỉ qua các công cụ tìm kiếm. <br>
Quá trình này thường bao gồm việc tìm kiếm nội dung không được bảo vệ trên website hoặc thông tin được lưu trữ trong chỉ mục của công cụ tìm kiếm.<br>
- Một số cách thực hiện phổ biến:<br>
        - Sử dụng Toán Tử Tìm Kiếm (Google Hacking): Sử dụng các toán tử tìm kiếm nâng cao (như site:, inurl:, và filetype:) để hạn chế và tinh chỉnh kết quả tìm kiếm, giúp tìm kiếm thông tin nhạy cảm hơn.<br>
        <img src="img/google-hacking-exam.png" alt="alt text" width="600"> <br>
        <img src="img/google-hacking2-exam.png" alt="alt text" width="600"> <br>
<a id="p3"></a>
## 3. Fingerprint Web Server<br>
Là một kỹ thuật thu thập thông tin nhằm xác định và nhận diện các đặc điểm,công nghệ hay Version service của một Web Application đang chạy. Việc này giúp người kiểm thử bảo mật hiểu rõ hơn về cấu trúc và các công nghệ đang được sử dụng, từ đó có thể phát hiện các lỗ hổng bảo mật tiềm ẩn. <br>
Một số cách Fingerprint Web Server phổ biến:<br>
- Phân tích Headers HTTP:<br>
    - Kiểm tra các tiêu đề HTTP (HTTP headers) trong phản hồi từ máy chủ. Những tiêu đề này thường chứa thông tin về phần mềm máy chủ, phiên bản và các công nghệ khác mà máy chủ đang sử dụng.<br>
    - Ví dụ: Header của Respone Server có thể chỉ ra Backend đang sử dụng framework ASP.NET <br>
     <img src="img/req-res-exam.png" alt="alt text" width="700" height='150'> <br>
- Kiểm tra File và Thư mục Mặc định:<br>
    - Một số Web Server có các file hoặc thư mục mặc định (như /admin, /phpmyadmin,/phpinfo.php, hoặc các file readme hoặc license) mà có thể tiết lộ thông tin về phần mềm và phiên bản.<br>
    <img src="img/admin-link-exam.png" alt="alt text" width="600"> <br>
    <img src="img/phpinfo-exam.png" alt="alt text" width="600"> <br>
- Sử dụng Công cụ và Phần mềm:<br>
    - Có nhiều công cụ tự động giúp thực hiện việc Fingerprinting, ví dụ như: <br>
        - VirusTotal:<br>
        <img src="img/visualtotal-exam.png" alt="alt text" width="600"> <br>
        - DNS Dumpster:<br>
        <img src="img/mapdump-exam.png" alt="alt text" width="600"> <br>
Ngoài các ví dụ trên thì còn rất nhiều các tool recon mạnh mẽ khác có thể phục vụ cho bước Information Gathering trong quá trình Pentest.<br>
<a id="p4"></a>
## 4. Review Web Server Metafiles for Information Leakage
Web Server Metafiles là các file chứa thông tin cấu hình và dữ liệu về hoạt động của Web Server, giúp thiết lập và quản lý cách Web Server xử lý yêu cầu từ người dùng. Việc xem xét các Metafiles này là bước quan trọng trong thu thập thông tin nhằm phát hiện lỗ hổng bảo mật hoặc thông tin nhạy cảm có thể bị rò rỉ. <br>
- Một số Metafiles thường gặp: <br>
    - File robots.txt chỉ định các đường dẫn không muốn thu thập, nhưng cũng có thể tiết lộ thông tin quan trọng. <br>
    <img src="img/robotstxt-exam.png" alt="alt text" width="600"> <br>
    - File sitemap.xml cung cấp cấu trúc trang web và các URL mà tổ chức muốn lập chỉ mục, bao gồm cả các tài liệu không được bảo vệ. Phân tích hai file này giúp xác định điểm yếu và lỗ hổng trong hệ thống.<br>
    <img src="img/sitemapxml-exam.png" alt="alt text" width="600"> <br>
- Nguyên nhân rò rỉ thông tin qua các Mtafiles:<br>
    - Thông tin về cấu hình: Nếu các Metafiles không được bảo vệ đúng cách, chúng có thể bị truy cập công khai, tiết lộ thông tin về cấu hình server và ứng dụng.<br>
    - Lỗi cấu hình: Các lỗi trong cấu hình có thể dẫn đến việc cho phép truy cập trái phép đến các file hoặc thư mục nhạy cảm.
    - Thông tin phiên bản: Việc lộ ra phiên bản phần mềm có thể giúp kẻ tấn công tìm ra các lỗ hổng bảo mật đã biết liên quan đến phiên bản đó.<br>
<a id="p5"></a>
## 5. Enumerate Applications on Webserver<br>
Là quá trình thu thập thông tin về các ứng dụng, dịch vụ và phần mềm đang chạy trên Web Server. Việc liệt kê này giúp kiểm tra các thành phần của server để xác định các ứng dụng có thể tồn tại lỗ hổng bảo mật hoặc có thể bị tấn công.<br>
- Mục tiêu chính:<br>
    - Xác định ứng dụng đang chạy: Các ứng dụng và dịch vụ có thể bao gồm các hệ thống quản lý nội dung (CMS) như WordPress, Joomla, Drupal, hay các framework như Django, Ruby on Rails.<br>
    - Phát hiện phiên bản ứng dụng: Kiểm tra phiên bản của ứng dụng hoặc dịch vụ giúp xác định xem có lỗ hổng bảo mật đã biết nào liên quan đến phiên bản đó không.<br>
    - Phát hiện các ứng dụng cũ hoặc không được bảo mật: Các ứng dụng không được cập nhật hoặc cài đặt không đúng cách có thể để lộ các lỗ hổng bảo mật.<br>
- Một số công cụ phổ biến:<br>
    - Nikto: Nikto là công cụ mã nguồn mở giúp kiểm tra máy chủ web và liệt kê các ứng dụng phổ biến. Nikto cũng phát hiện các lỗ hổng bảo mật đã biết.<br>
    <img src="img/nikto-exam.png" alt="alt text" width="600"> <br>
    - Nmap: Một công cụ quét mạng phổ biến có thể được sử dụng để phát hiện các ứng dụng và dịch vụ đang chạy trên một server, bao gồm các phiên bản ứng dụng.<br>
    <img src="img/nmap-exam.png" alt="alt text" width="600"> <br>
    <img src="img/nmap2-exam.png" alt="alt text" width="600"> <br>
<a id="p6"></a>
## 6. Review Webpage Content for Information Leakage
Là quá trình phân tích các nội dung, thành phần và tài nguyên trên một trang web để xác định xem có thông tin nhạy cảm nào có thể bị lộ ra ngoài hay không. Quá trình này rất quan trọng trong việc bảo mật thông tin, vì những dữ liệu bị lộ có thể được khai thác bởi kẻ tấn công. <br>
Trong quá trình phát triển Web Application, các Dev thường xuyên "take note" ngay trong chính source code của mình để tiện cho việc phát triển, nhưng khi final project thì lại quên mất việc xóa những note nhạy cảm, vô tình làm rò rỉ các thông tin nhạy cảm.<br>
Ví dụ:<br>
    <img src="img/note-exam.png" alt="alt text" width="600"> <br>
    <img src="img/note2-exam.png" alt="alt text" width="600"> <br>
    <img src="img/note3-exam.png" alt="alt text" width="600"> <br>
Kết luận: việc đọc source code trước và trong khi thực hiện Pentest cũng là 1 phần rất quan trọng, không thế thiếu nếu không muốn bỏ sót một thông tin nào.<br>
<a id="p7"></a>
## 7. Identify Application Entry Points
Là quá trình xác định các Entry Poins mà User và Server có thể tương tác qua lại. Những điểm này bao gồm các API, Service mà User có thể truy cập để thực hiện các hành động như: Register, Login, Search, truy xuất data,... <br>
- Minh họa:<br>
    Đây là 1 login entry point có input bình thường <br>
    <img src="img/entrypoint3-exam.png" alt="alt text" width="700"> <br>
    Đây là 1 login entry point có input bất thường <br>
    <img src="img/entrypoint4-exam.png" alt="alt text" width="700"> <br>
Sau khi phát hiện bất thường từ việc xác định các entry point ta có thể tiến hành test vài testcase cơ bản để "take note" các error entry point. <br>
    <img src="img/entrypoint5-exam.png" alt="alt text" width="700"> <br>


<a id="p8"></a>
## 8. Map Execution Paths Through Application <br>
Là quá trình xác định và mô tả "work flow" của Target. <br>
Trước khi thực hiện Pentest, Pentester phải trải nghiệm Target như 1 User, qua đó nắm được "work flow" cũng như quá trình xử lý dữ liệu của Target để tiến hành Pentest.<br>
- Phương pháp phổ biến:<br>
    - Sử dụng công cụ phân tích: Sử dụng các công cụ như Burp Suite để theo dõi các yêu cầu HTTP và phân tích cách mà ứng dụng phản hồi.<br>
    <img src="img/bs-exam.png" alt="alt text" width="600"> <br>
    - Theo dõi luồng dữ liệu (Data Flow): Xem xét cách mà dữ liệu di chuyển từ input (đầu vào) đến output (đầu ra), xác định các điểm kiểm tra và xử lý.<br>
    - Phân tích kiến trúc ứng dụng: Nghiên cứu sơ đồ kiến trúc để hiểu cách các thành phần tương tác với nhau. Ta có thể sử dụng các công cụ như dirsearch,... để tìm thư mục, tệp trong hệ thống<br>
    <img src="img/dirsearch-exam.png" alt="alt text" width="600"> <br>
<a id="p9"></a>
## 9. Fingerprint Web Application Framework <br>
Là quá trình xác định và nhận diện framework mà Web Application đang sử dụng. Điều này giúp hiểu rõ hơn về công nghệ mà ứng dụng dựa vào, từ đó có thể tìm ra các lỗ hổng bảo mật hoặc cách khai thác phù hợp với framework đó. <br>
- Tại sao cần nhận diện framework? <br>
        - Lỗ hổng bảo mật: Mỗi framework đều các lỗ hổng bảo mật cụ thể mà bạn có thể khai thác, hoặc đã có người khai thác <br>
        (VD: CVE-2023-48003 của framework ASP.NET phiên bản trước 12.3.0). Việc nhận diện framework giúp bạn tìm hiểu những điểm yếu này. <br>
        - Phân tích mối đe dọa: Hiểu rõ framework cho phép bạn phân tích các mối đe dọa mà ứng dụng có thể đối mặt <br>
        - Tùy chỉnh phương pháp kiểm thử: Mỗi framework có cách xử lý và cấu trúc riêng, do đó việc nhận diện giúp bạn điều chỉnh phương pháp kiểm thử cho phù hợp tránh mất thời gian. <br>
Minh họa: <br>
    - Ví dụ: Thực hiện gửi 1 Req đến Target và check Res trả về, Header có thể chỉ ra ứng dụng đang sử dụng framework ASP.NET qua header set cookie ở dòng số 5 <br>
     <img src="img/req-res-exam.png" alt="alt text" width="700" height='150'> <br>
<a id="p10"></a>



