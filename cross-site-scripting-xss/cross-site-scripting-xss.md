# Tìm hiểu về Cross-Site Scripting
> TÊN TÀI LIỆU: Cross-Site Scripting Document <br>
THỰC HIỆN: Dương Tôn Hoàng Khang <br>
CẬP NHẬT CUỐI CÙNG: 03/10/2024<br>
>
## Mục lục
#### [1. What is XSS (Cross-Site Scripting)?](#p1)<br>
#### [2. Các dạng lỗi XSS](#p2)<br>
#### [3. Cách thức tìm kiếm và khai thác](#p3)<br>

<a id="p1"></a> <br>
## 1. What is XSS (Cross-Site Scripting)?<br>
Là lỗ hổng bảo mật phổ biến trong Web Application, cho phép Attacker chèn mã độc (thường là JavaScript) vào trang web mà user khác có thể truy cập. Lỗ hổng này có thể dẫn đến việc đánh cắp thông tin nhạy cảm (như cookie, token phiên), thao tác nội dung trang, hoặc thậm chí tấn công vào người dùng khác.<br>
<a id="p2"></a>
## 2. Các dạng lỗi XSS<br>
XSS có 3 dạng lỗi chính:<br>
- Stored XSS (XSS lưu trữ): Mã độc được lưu trữ trên server (thường là trong cơ sở dữ liệu) và được thực thi khi người dùng truy cập vào trang web chứa mã đó. <br>
    - VD: ta có chức năng comment bài blog sau và test chức năng nay với payload như hình <br>
    <img src="img/xss3-exam.png" alt="alt text" width="600"> <br>
Sau khi post comment thành công <br>
    <img src="img/xss4-exam.png" alt="alt text" width="600"> <br>
Quay lại bài blog vừa comment, payload vừa test đã được thực thi => chức năng comment này bị Stored XSS <br>
    <img src="img/xss5-exam.png" alt="alt text" width="600"> <br>
- Reflected XSS (XSS phản hồi): Mã độc được chèn trực tiếp vào URL hoặc form và được thực thi khi trang web phản hồi lại người dùng mà không kiểm tra mã độc.<br>
    - VD: ta có Blog sau và thanh search, vì blackbox nên ta phải test tất cả trường hợp có thể xảy ra, input payload như hình <br>
<img src="img/xss-exam.png" alt="alt text" width="600"> <br>
Ta nhận lại được output như sau: <br>
<img src="img/xss2-exam.png" alt="alt text" width="600"> <br>
Vậy xác định search entry point này bị Reflected XSS<br>
- DOM-based XSS: XSS xảy ra khi mã độc được thực thi trực tiếp trong trình duyệt của người dùng, thông qua việc thao tác DOM (Document Object Model) của trang.<br>
    - VD: ta có blog như hình và search 1 gì đấy ngẫu nhiên
<img src="img/xss6-exam.png" alt="alt text" width="600"> <br>
Kết quả <br>
<img src="img/xss7-exam.png" alt="alt text" width="600"> <br>
Tưởng đâu cụt đường rồi, nhưng mà F12 check nhẹ source code thì thấy<br>
<img src="img/xss8-exam.png" alt="alt text" width="600"> <br>
Vậy là input truyền vào sẽ được thay vào para ?searchTerm=input <br>
Giờ test thử payload<br>
<img src="img/xss9-exam.png" alt="alt text" width="600"> <br>
Kết quả: ta dùng dấu "> để đóng thẻ img và mở thẻ svg chèn script vào <br>
<img src="img/xss10-exam.png" alt="alt text" width="600"> <br>

<a id="p3"></a>
## 3. Cách thức tìm kiếm và khai thác<br>
Để tìm kiếm và khai thác lỗ hổng XSS (Cross-Site Scripting), bạn có thể thực hiện theo các bước sau:<br>
- Kiểm tra input đầu vào của user<br>
    - XSS thường xuất hiện khi dữ liệu từ user không được filter đúng cách trước khi được hiển thị lại trên trang web. Cần xác định tất cả các điểm mà trang web chấp nhận đầu vào từ người dùng, chẳng hạn như:<br>
        - Login form, chức năng search<br>
        - Chức năng comment<br>
        - URL (query parameters)<br>
        - Cookies, headers<br>
- Chèn srcipt đơn giản để kiểm tra<br>
    - Bắt đầu bằng cách nhập các đoạn mã JavaScript đơn giản vào các điểm đầu vào và quan sát phản hồi của trang. Ví dụ:<br>
        <img src="img/xss-exam.png" alt="alt text" width="600"> <br>
        <img src="img/xss2-exam.png" alt="alt text" width="600"> <br>

Sau khi xác định chức năng bị XSS, ta có thể khai thác sâu hơn, ví dụ như: <br>
-  Đánh cắp cookie của người dùng
- Thực thi mã JavaScript độc hạ
- Chèn keylogger
- Redirect user đến trang giả mạo để Phishing Attack.